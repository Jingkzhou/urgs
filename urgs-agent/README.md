# urgs-agent

URGS æ™ºèƒ½ç¼–æ’æœåŠ¡ï¼ŒåŸºäº **CrewAI** å®ç°å¤š Agent åä½œã€‚è´Ÿè´£å¯¹è¯ç®¡ç†ã€ä»»åŠ¡ç¼–æ’ã€å·¥å…·è°ƒç”¨ã€å®¡æ‰¹ä¸å®¡è®¡è¾“å‡ºã€‚

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FastAPI å…¥å£å±‚                            â”‚
â”‚         /chat â”‚ /chat/stream â”‚ /sessions â”‚ /approvals           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CrewAI å¤š Agent åä½œå±‚                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  åè°ƒå‘˜      â”‚ â”‚ RAG ä¸“å®¶    â”‚ â”‚ è¡€ç¼˜åˆ†æå¸ˆ   â”‚ â”‚ æ‰§è¡Œè€…    â”‚ â”‚
â”‚  â”‚ Coordinator â”‚ â”‚ RAG Expert  â”‚ â”‚  Lineage    â”‚ â”‚ Executor  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å·¥å…·å±‚                                 â”‚
â”‚    RAG çŸ¥è¯†æ£€ç´¢ â”‚ SQL è¡€ç¼˜åˆ†æ â”‚ ä»»åŠ¡æŸ¥è¯¢/æ‰§è¡Œ â”‚ æ–‡æ¡£æœç´¢          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å¤–éƒ¨æœåŠ¡                                 â”‚
â”‚      urgs-rag (8001) â”‚ sql-lineage-engine â”‚ urgs-api (8080)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
cd urgs-agent

# å¯åŠ¨æœåŠ¡ (è‡ªåŠ¨å¤„ç†ä¾èµ–å’Œç¯å¢ƒ)
chmod +x start.sh
./start.sh
```

### ç¯å¢ƒå˜é‡é…ç½®

è„šæœ¬ `start.sh` å·²åŒ…å«é»˜è®¤é…ç½®ï¼Œå¦‚éœ€ä¿®æ”¹ï¼Œå¯ç¼–è¾‘è¯¥è„šæœ¬æˆ–åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# LLM é…ç½®
export OPENAI_BASE_URL=http://localhost:11434/v1
export OPENAI_API_KEY=your-api-key
export MODEL_NAME=qwen3

# æœåŠ¡åœ°å€
export RAG_SERVICE_URL=http://localhost:8001      # urgs-rag æœåŠ¡
export LINEAGE_SERVICE_URL=http://localhost:8002  # sql-lineage-engine
export API_SERVICE_URL=http://localhost:8080      # urgs-api åç«¯
```

## ğŸ“ ç›®å½•ç»“æ„

```
urgs-agent/
â”œâ”€â”€ agent/
â”‚   â”œâ”€â”€ agents.py          # CrewAI Agent å®šä¹‰ï¼ˆ4 ä¸ªè§’è‰²ï¼‰
â”‚   â”œâ”€â”€ crews.py           # Crew å›¢é˜Ÿç¼–æ’ä¸æ„å›¾åˆ†ç±»
â”‚   â”œâ”€â”€ tasks.py           # Task ä»»åŠ¡æ¨¡æ¿ï¼ˆ7 ç§ä»»åŠ¡ç±»å‹ï¼‰
â”‚   â”œâ”€â”€ tools/             # å·¥å…·å±‚
â”‚   â”‚   â””â”€â”€ __init__.py    # 7 ä¸ªå·¥å…·ï¼šRAG/è¡€ç¼˜/æ‰§è¡Œå™¨
â”‚   â””â”€â”€ policies/          # ç­–ç•¥
â”‚       â”œâ”€â”€ approval_policy.py   # å®¡æ‰¹ç­–ç•¥
â”‚       â”œâ”€â”€ injection_guard.py   # æ³¨å…¥é˜²æŠ¤
â”‚       â””â”€â”€ tool_policy.py       # å·¥å…·ç™½åå•
â”œâ”€â”€ app/                   # FastAPI åº”ç”¨
â”‚   â”œâ”€â”€ main.py            # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ routes/            # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ chat.py        # èŠå¤©æ¥å£
â”‚   â”‚   â”œâ”€â”€ sessions.py    # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ approvals.py   # å®¡æ‰¹æ¥å£
â”‚   â”‚   â””â”€â”€ health.py      # å¥åº·æ£€æŸ¥
â”‚   â””â”€â”€ middleware/        # ä¸­é—´ä»¶ï¼ˆTraceIDã€Authï¼‰
â”œâ”€â”€ core/                  # æ ¸å¿ƒé…ç½®
â”‚   â”œâ”€â”€ config.py          # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ logging.py         # æ—¥å¿—
â”œâ”€â”€ storage/               # å­˜å‚¨å±‚
â”‚   â”œâ”€â”€ session_store.py   # ä¼šè¯å­˜å‚¨ï¼ˆå†…å­˜/Redisï¼‰
â”‚   â””â”€â”€ audit_store.py     # å®¡è®¡æ—¥å¿—
â”œâ”€â”€ schemas/               # API æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ api.py             # è¯·æ±‚/å“åº”æ¨¡å‹
â”‚   â””â”€â”€ events.py          # SSE äº‹ä»¶æ¨¡å‹
â”œâ”€â”€ llm/                   # LLM å®¢æˆ·ç«¯
â””â”€â”€ tests/                 # æµ‹è¯•
```

## ğŸ¤– Agent è§’è‰²

| Agent | èŒè´£ | å·¥å…· |
|-------|------|------|
| **åè°ƒå‘˜** | ç†è§£ç”¨æˆ·æ„å›¾ï¼Œåˆ†æ´¾ä»»åŠ¡ï¼Œæ±‡æ€»ç»“æœ | å…¨éƒ¨å·¥å…· |
| **RAG ä¸“å®¶** | ä»çŸ¥è¯†åº“æ£€ç´¢æ–‡æ¡£å’Œä¿¡æ¯ | RAGçŸ¥è¯†æ£€ç´¢ã€æ–‡æ¡£æ‘˜è¦æ£€ç´¢ |
| **è¡€ç¼˜åˆ†æå¸ˆ** | è§£æ SQL è·å–è¡¨/å­—æ®µçº§è¡€ç¼˜ | SQLè¡€ç¼˜åˆ†æã€æŸ¥è¯¢è¡¨è¡€ç¼˜å…³ç³» |
| **ä»»åŠ¡æ‰§è¡Œè€…** | è§¦å‘å’Œç®¡ç†è°ƒåº¦ä»»åŠ¡ | æŸ¥è¯¢ä»»åŠ¡åˆ—è¡¨ã€ä»»åŠ¡è¯¦æƒ…ã€è§¦å‘æ‰§è¡Œ |

## ğŸ”§ å·¥å…·åˆ—è¡¨

| å·¥å…·å | åŠŸèƒ½ | è°ƒç”¨æœåŠ¡ |
|--------|------|----------|
| **RAGçŸ¥è¯†æ£€ç´¢** | ä»çŸ¥è¯†åº“æ£€ç´¢ä¿¡æ¯ | urgs-rag |
| **æ–‡æ¡£æ‘˜è¦æ£€ç´¢** | æ ¹æ®å…³é”®è¯æœç´¢æ–‡æ¡£ | urgs-rag |
| **SQLè¡€ç¼˜åˆ†æ** | è§£æ SQL æå–è¡€ç¼˜å…³ç³» | sql-lineage-engine |
| **æŸ¥è¯¢è¡¨è¡€ç¼˜å…³ç³»** | æŸ¥è¯¢è¡¨çš„ä¸Šä¸‹æ¸¸ä¾èµ– | urgs-api |
| **æŸ¥è¯¢ä»»åŠ¡åˆ—è¡¨** | è·å–è°ƒåº¦ä»»åŠ¡åˆ—è¡¨ | urgs-api |
| **æŸ¥è¯¢ä»»åŠ¡è¯¦æƒ…** | è·å–æŒ‡å®šä»»åŠ¡è¯¦æƒ… | urgs-api |
| **è§¦å‘ä»»åŠ¡æ‰§è¡Œ** | æ‰§è¡Œè°ƒåº¦ä»»åŠ¡ï¼ˆéœ€å®¡æ‰¹ï¼‰ | urgs-api |

## ğŸ“¡ API æ¥å£

### POST /chat
åŒæ­¥èŠå¤©æ¥å£

```bash
curl -X POST http://localhost:8002/chat \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "u001",
    "text": "å¸®æˆ‘åˆ†æè¿™æ¡ SQL çš„è¡€ç¼˜å…³ç³»ï¼šSELECT a.id, b.name FROM t1 a JOIN t2 b ON a.id = b.id"
  }'
```

## ğŸ§­ æ‰§è¡Œé“¾è·¯ï¼ˆ/chat ç¤ºä¾‹ï¼‰

ä¸‹é¢ä»¥ `POST /chat` ä¸ºä¸»çº¿ï¼Œè¯´æ˜â€œç»Ÿè®¡ä»»åŠ¡æ•°é‡â€è¿™ç±»è¯·æ±‚åœ¨ä»£ç é‡Œçš„æ‰§è¡Œè·¯å¾„ï¼Œä»¥åŠæ¯ä¸ªæ¨¡å—çš„èŒè´£ã€‚

### 1) å…¥å£ä¸ä¸­é—´ä»¶

- `app/main.py`ï¼šåˆ›å»º FastAPI åº”ç”¨ï¼Œæ³¨å†Œè·¯ç”±ä¸ä¸­é—´ä»¶ã€‚
- `app/middleware/trace.py`ï¼šä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆ/é€ä¼  `X-Trace-Id`ï¼Œä¾¿äºé“¾è·¯è¿½è¸ªã€‚
- `app/middleware/auth.py`ï¼šä» `X-User-Id` è¯»å–ç”¨æˆ·èº«ä»½åˆ° `request.state`ï¼ˆå½“å‰æœªåšå¼ºæ ¡éªŒï¼‰ã€‚

### 2) /chat è·¯ç”±æ ¸å¿ƒæµç¨‹

`app/routes/chat.py::chat_endpoint` åšäº†ä»¥ä¸‹æ­¥éª¤ï¼š

1. **æç¤ºæ³¨å…¥æ£€æµ‹**ï¼š`InjectionGuard.assert_safe` å¯¹è¾“å…¥åšå®‰å…¨æ£€æŸ¥ï¼Œå‘½ä¸­è§„åˆ™ä¼šæŠ›é”™æ‹¦æˆªè¯·æ±‚ã€‚
2. **ä¼šè¯åˆ›å»º**ï¼š`session_store.create_session` åˆ›å»ºä¼šè¯å¹¶ä¿å­˜ä¸Šä¸‹æ–‡ã€‚
3. **å®¡è®¡äº‹ä»¶**ï¼š`audit_store.record_event` å†™å…¥ `chat_started` å®¡è®¡è®°å½•ã€‚
4. **å®¡æ‰¹åˆ¤æ–­**ï¼š`_maybe_require_approval` æ£€æµ‹å±é™©å…³é”®è¯ï¼ˆå¦‚æ‰§è¡Œ/trigger/drop ç­‰ï¼‰ã€‚
   - è‹¥å‘½ä¸­ï¼Œå†™å…¥å¾…å®¡æ‰¹å¹¶è¿”å› `NEED_APPROVAL`ã€‚
5. **CrewAI æ‰§è¡Œ**ï¼š`run_crew` è¿›å…¥å¤š Agent åä½œæµç¨‹ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚
6. **ç»“æœè½åº“ä¸è¿”å›**ï¼šè®°å½• `final_answer` å®¡è®¡äº‹ä»¶å¹¶æ›´æ–°ä¼šè¯çŠ¶æ€ä¸º `COMPLETED`ã€‚

### 3) CrewAI ä»»åŠ¡ç¼–æ’

`agent/crews.py::run_crew` è´Ÿè´£æ„å›¾åˆ†ç±»ä¸ Crew é€‰æ‹©ï¼š

- `classify_intent` å…ˆæŒ‰å…³é”®è¯åˆ¤æ–­æ„å›¾ï¼ˆæ³¨æ„ï¼š**ä»»åŠ¡å…³é”®è¯ä¼˜å…ˆäºç»Ÿè®¡å…³é”®è¯**ï¼‰ã€‚
- å¯¹åº”çš„ Crew é€‰æ‹©å¦‚ä¸‹ï¼š
  - `job` â†’ `create_job_management_crew`
  - `data` â†’ `create_data_analysis_crew`
  - `lineage` / `rag` / `general` â†’ å¯¹åº” Crew

> ä¾‹ï¼šè¾“å…¥â€œå¸®æˆ‘ç»Ÿè®¡ä¸€ä¸‹ç°åœ¨æœ‰å¤šå°‘ä¸ªä»»åŠ¡ï¼Ÿâ€åŒ…å«â€œä»»åŠ¡â€å…³é”®è¯ï¼Œå› æ­¤ä¼˜å…ˆèµ° **job** æµç¨‹ã€‚

### 4) ä»»åŠ¡æ‰§è¡Œä¸å·¥å…·è°ƒç”¨

ä»¥ **job æµç¨‹** ä¸ºä¾‹ï¼š

- `agent/tasks.py::create_job_status_task` ç”Ÿæˆâ€œæŸ¥è¯¢ä»»åŠ¡çŠ¶æ€â€ä»»åŠ¡ã€‚
- `agent/agents.py::create_executor_agent` ä½œä¸ºæ‰§è¡Œè€… Agentã€‚
- `agent/tools/__init__.py::list_jobs` è°ƒç”¨ `urgs-api`ï¼š`GET /api/jobs`ã€‚
- CrewAI æ±‡æ€»å·¥å…·è¿”å›çš„ä»»åŠ¡åˆ—è¡¨ï¼Œç”Ÿæˆæœ€ç»ˆæ–‡æœ¬å“åº”ã€‚

è‹¥è¿›å…¥ **data æµç¨‹**ï¼š

- `agent/tasks.py::create_sql_query_task` æè¿°â€œç”Ÿæˆ SQL å¹¶æŸ¥è¯¢æ•°æ®åº“â€ã€‚
- `agent/tools/__init__.py::get_sql_tool` ä½¿ç”¨ `NL2SQLTool` å¯¹ MySQL æ‰§è¡Œ **åªè¯»æŸ¥è¯¢**ã€‚

### 5) å®¡æ‰¹ä¸ä¼šè¯/å®¡è®¡

- `agent/policies/approval_policy.py`ï¼šæ„é€  `PendingApproval` ä¸è¿‡æœŸæ—¶é—´ã€‚
- `app/routes/approvals.py`ï¼šç¡®è®¤/æ‹’ç»å®¡æ‰¹ï¼Œæ›´æ–°ä¼šè¯çŠ¶æ€ã€‚
- `storage/session_store.py`ï¼šä¼šè¯ã€äº‹ä»¶ã€å®¡æ‰¹æš‚å­˜ï¼ˆé»˜è®¤å†…å­˜ï¼‰ã€‚
- `storage/audit_store.py`ï¼šå®¡è®¡æ—¥å¿—è®°å½•ä¸æŸ¥è¯¢ã€‚

### 6) æµå¼æ¥å£ /chat/stream

`app/routes/chat.py::chat_stream` ç”¨ SSE æ¨é€æ‰§è¡Œè¿‡ç¨‹ï¼š

- `start` äº‹ä»¶ï¼šè¿”å› session_idã€‚
- `token` äº‹ä»¶ï¼šæç¤ºå½“å‰å¤„ç†é˜¶æ®µï¼ˆæ„å›¾ã€Crew æ‰§è¡Œä¸­ï¼‰ã€‚
- `need_approval` / `final` / `error`ï¼šæœ€ç»ˆç»“æœæˆ–é”™è¯¯ã€‚

## ğŸ” å…³é”®ä»£ç ä½ç½®é€ŸæŸ¥

- å…¥å£ä¸è·¯ç”±ï¼š`app/main.py`ã€`app/routes/chat.py`
- æ„å›¾åˆ†ç±»ä¸ç¼–æ’ï¼š`agent/crews.py`
- Agent è§’è‰²å®šä¹‰ï¼š`agent/agents.py`
- Task æ¨¡æ¿ï¼š`agent/tasks.py`
- å·¥å…·è°ƒç”¨ï¼š`agent/tools/__init__.py`
- å®¡æ‰¹/å®‰å…¨ï¼š`agent/policies/approval_policy.py`ã€`agent/policies/injection_guard.py`
- ä¼šè¯/å®¡è®¡ï¼š`storage/session_store.py`ã€`storage/audit_store.py`
- é…ç½®ä¸æ—¥å¿—ï¼š`core/config.py`ã€`core/logging.py`

**å“åº”ç¤ºä¾‹**ï¼š
```json
{
  "session_id": "s_abc123",
  "message_id": "msg_xyz789",
  "answer": "**æºè¡¨**: t1, t2\n**ç›®æ ‡è¡¨**: æ— \n**å­—æ®µè¡€ç¼˜**: a.id, b.name",
  "status": "COMPLETED"
}
```

### POST /chat/stream
æµå¼èŠå¤©æ¥å£ (SSE)ï¼Œå®æ—¶è¿”å›å¤„ç†è¿›åº¦

### GET /sessions/{session_id}
è·å–ä¼šè¯æ‘˜è¦

### GET /sessions/{session_id}/events
è·å–ä¼šè¯äº‹ä»¶å†å²ï¼ˆç”¨äºå›æ”¾ï¼‰

### POST /approvals/{approval_id}/confirm
ç¡®è®¤æˆ–æ‹’ç»å¾…å®¡æ‰¹æ“ä½œ

### GET /health
å¥åº·æ£€æŸ¥

## ğŸ›¡ï¸ å®¡æ‰¹æœºåˆ¶

å½“æ£€æµ‹åˆ°å±é™©æ“ä½œå…³é”®è¯æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¦æ±‚äººå·¥å®¡æ‰¹ï¼š

| å…³é”®è¯ | æ“ä½œç±»å‹ |
|--------|----------|
| åˆ é™¤ã€dropã€truncate | æ•°æ®åˆ é™¤ |
| æ‰§è¡Œã€è¿è¡Œã€trigger | ä»»åŠ¡æ‰§è¡Œ |
| é‡è·‘ã€update | æ•°æ®ä¿®æ”¹ |

**å®¡æ‰¹æµç¨‹**ï¼š
1. ç³»ç»Ÿæ£€æµ‹åˆ°å±é™©æ“ä½œ â†’ è¿”å› `NEED_APPROVAL` çŠ¶æ€
2. ç”¨æˆ·é€šè¿‡ `/approvals/{id}/confirm` ç¡®è®¤æˆ–æ‹’ç»
3. ç¡®è®¤åç³»ç»Ÿç»§ç»­æ‰§è¡Œï¼Œæ‹’ç»åˆ™ç»ˆæ­¢

## âš™ï¸ ä¾èµ–æœåŠ¡

å®Œæ•´åŠŸèƒ½éœ€è¦ä»¥ä¸‹æœåŠ¡è¿è¡Œï¼š

| æœåŠ¡ | ç«¯å£ | è¯´æ˜ |
|------|------|------|
| urgs-rag | 8001 | çŸ¥è¯†åº“æ£€ç´¢æœåŠ¡ |
| urgs-api | 8080 | åç«¯ API æœåŠ¡ |
| sql-lineage-engine | - | SQL è¡€ç¼˜åˆ†æï¼ˆå‘½ä»¤è¡Œ/APIï¼‰ |

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/ -v

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/test_health.py -v
```

## ğŸ“¦ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: FastAPI, CrewAI
- **LLM**: æ”¯æŒ OpenAI API å…¼å®¹æ¥å£ï¼ˆå¦‚ Ollamaï¼‰
- **å­˜å‚¨**: å†…å­˜ï¼ˆé»˜è®¤ï¼‰/ Redis / MySQL
- **æ—¥å¿—**: structlog
